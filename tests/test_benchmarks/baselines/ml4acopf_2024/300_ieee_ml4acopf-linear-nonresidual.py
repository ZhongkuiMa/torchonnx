"""PyTorch module generated by TorchONNX.

Source: /mnt/hdd1/zhongkui/rover_project/rover_alpha/torchonnx/tests/vnncomp2024_benchmarks/ml4acopf_2024/onnx/300_ieee_ml4acopf-linear-nonresidual.onnx
Generated: 2025-12-22 03:36:18

This module was automatically converted from an ONNX model.
"""

__all__ = ["Ml4acopf2024300IeeeMl4acopfLinearNonresidual"]

import torch
import torch.nn as nn


class Ml4acopf2024300IeeeMl4acopfLinearNonresidual(nn.Module):
    def __init__(self):
        super().__init__()
        self.register_buffer("c5", torch.empty([54], dtype=torch.float32))
        self.register_buffer("c6", torch.empty([54], dtype=torch.float32))
        self.register_buffer("c8", torch.empty([438], dtype=torch.float32))
        self.register_buffer("c9", torch.empty([438], dtype=torch.float32))
        self.register_buffer("c38", torch.empty([411], dtype=torch.int64))
        self.register_buffer("c39", torch.empty([411], dtype=torch.int64))
        self.register_buffer("c41", torch.empty([55], dtype=torch.float32))
        self.register_buffer("c42", torch.empty([55], dtype=torch.float32))
        self.register_buffer("c45", torch.empty([55], dtype=torch.float32))
        self.register_buffer("c46", torch.empty([55], dtype=torch.float32))
        self.register_buffer("c49", torch.empty([411], dtype=torch.float32))
        self.register_buffer("c50", torch.empty([411], dtype=torch.float32))
        self.register_buffer("c51", torch.empty([411], dtype=torch.float32))
        self.register_buffer("c52", torch.empty([411], dtype=torch.float32))
        self.register_buffer("c53", torch.empty([411], dtype=torch.float32))
        self.register_buffer("c54", torch.empty([411], dtype=torch.float32))
        self.register_buffer("c55", torch.empty([411], dtype=torch.float32))
        self.register_buffer("c56", torch.empty([411], dtype=torch.float32))
        self.register_buffer("c57", torch.empty([411], dtype=torch.float32))
        self.register_buffer("c58", torch.empty([411], dtype=torch.float32))
        self.register_buffer("c59", torch.empty([411], dtype=torch.float32))
        self.register_buffer("c60", torch.empty([300, 201], dtype=torch.float32))
        self.register_buffer("c61", torch.empty([300, 69], dtype=torch.float32))
        self.register_buffer("c62", torch.empty([300, 411], dtype=torch.float32))
        self.register_buffer("c63", torch.empty([300, 411], dtype=torch.float32))
        self.register_buffer("c64", torch.empty([300], dtype=torch.float32))
        self.register_buffer("c65", torch.empty([300], dtype=torch.float32))
        self.linear1 = nn.Linear(402, 256)
        self.relu1 = nn.ReLU()
        self.linear2 = nn.Linear(256, 256)
        self.relu2 = nn.ReLU()
        self.linear3 = nn.Linear(256, 512)
        self.relu3 = nn.ReLU()
        self.linear4 = nn.Linear(512, 738)
        self.relu4 = nn.ReLU()
        self.relu5 = nn.ReLU()
        self.relu6 = nn.ReLU()

    def forward(self, x0):
        x1 = self.linear1(x0)
        x2 = self.relu1(x1)
        x3 = self.linear2(x2)
        x4 = self.relu2(x3)
        x5 = self.linear3(x4)
        x6 = self.relu3(x5)
        x7 = self.linear4(x6)
        x8 = x7[:, 0:438]
        x9 = x8.unsqueeze(-1)
        x10 = x9 - self.c5
        x11 = self.relu4(x10)
        x12 = x11 @ self.c6
        x13 = x12 + 4.539787187241018e-05
        x14 = x13 * self.c8
        x15 = x14 + self.c9
        x16 = x7[:, 438:]
        x17 = torch.cat([x15, x16], dim=1)
        x18 = x0[:, 0:201]
        x19 = x0[:, 201:402]
        x20 = x17[:, 0:69]
        x21 = x17[:, 69:138]
        x22 = x17[:, 138:438]
        x23 = x17[:, 438:738]
        x24 = x23.index_select(1, self.c38.reshape(-1).long())
        x25 = x23.index_select(1, self.c39.reshape(-1).long())
        x26 = x24 - x25
        x27 = x22.index_select(1, self.c38.reshape(-1).long())
        x28 = x22.index_select(1, self.c39.reshape(-1).long())
        x29 = x27 * x27
        x30 = x28 * x28
        x31 = x26.unsqueeze(-1)
        x32 = x31 - self.c41
        x33 = self.relu5(x32)
        x34 = x33 @ self.c42
        x35 = x34 + -4.371138828673793e-08
        x36 = x26.unsqueeze(-1)
        x37 = x36 - self.c45
        x38 = self.relu6(x37)
        x39 = x38 @ self.c46
        x40 = x39 + -1
        x41 = x27 * x28
        x42 = x41 * x35
        x43 = x41 * x40
        x44 = x43 * -1
        x45 = self.c49 * x29
        x46 = self.c50 * x42
        x47 = x45 + x46
        x48 = self.c51 * x43
        x49 = x47 + x48
        x50 = self.c52 * x29
        x51 = self.c53 * x42
        x52 = x50 - x51
        x53 = self.c54 * x43
        x54 = x52 + x53
        x55 = self.c55 * x30
        x56 = x55 + x46
        x57 = self.c56 * x44
        x58 = x56 + x57
        x59 = self.c57 * x30
        x60 = x59 - x51
        x61 = self.c58 * x44
        x62 = x60 + x61
        x63 = x49 * x49
        x64 = x54 * x54
        x65 = x63 + x64
        x66 = x65 - self.c59
        x67 = x58 * x58
        x68 = x62 * x62
        x69 = x67 + x68
        x70 = x69 - self.c59
        x71 = x18.permute((1, 0))
        x72 = self.c60 @ x71
        x73 = x72.permute((1, 0))
        x74 = x19.permute((1, 0))
        x75 = self.c60 @ x74
        x76 = x75.permute((1, 0))
        x77 = x20.permute((1, 0))
        x78 = self.c61 @ x77
        x79 = x78.permute((1, 0))
        x80 = x21.permute((1, 0))
        x81 = self.c61 @ x80
        x82 = x81.permute((1, 0))
        x83 = x49.permute((1, 0))
        x84 = self.c62 @ x83
        x85 = x84.permute((1, 0))
        x86 = x58.permute((1, 0))
        x87 = self.c63 @ x86
        x88 = x87.permute((1, 0))
        x89 = x54.permute((1, 0))
        x90 = self.c62 @ x89
        x91 = x90.permute((1, 0))
        x92 = x62.permute((1, 0))
        x93 = self.c63 @ x92
        x94 = x93.permute((1, 0))
        x95 = x22 * x22
        x96 = x79 - x73
        x97 = x96 - x88
        x98 = x97 - x85
        x99 = self.c64 * x95
        x100 = x98 - x99
        x101 = x82 - x76
        x102 = x101 - x94
        x103 = x102 - x91
        x104 = self.c65 * x95
        x105 = x103 + x104
        x106 = torch.cat([x17, x49, x58, x54, x62, x66, x70, x100, x105], dim=1)
        return x106
